# Chapter1_PID_learning

这篇README开始于2025.2.11，这意味着我开始学习写PID控制代码了。

但是很显然这是

Very very tough thing!

But I will try!

OK here's the start.

----

## 常用的PID算法：

### PI算法

特点：

- 从时域上看，只要存在偏差，积分就会不停对偏差进行积累，因此稳态时误差一定为零

- 比例与积分动作都是对过去控制误差进行操作，不对未来控制误差进行预测，限制了控制性能。

- PI调节将比例调节的快速反映和积分调节消除静差的特点结合实现好的调节效果。

- PI调节适用于控制通道滞后较小，负荷变化不大、工艺参数不允许有静差的系统。

### PD算法

适用于舵机的快速响应
对于惯性较大的对象，常常希望能够加快控制速度，此时可增加微分的作用。

特点：

- 比例控制对于惯性较大对象，控制过程缓慢，控制品质不佳。比例微分控制可提高控制速度，对惯性较大对象，可改善控制质量，减小偏差，缩短控制时间。
- 理想微分作用持续时间太短，执行器来不及响应。实际使用中，一般加以惯性延迟，称为实际微分。
- PD调节以比例调节为主，微分调节为辅，PD调节三有差调节。
- PD调节具有提高系统稳定性、抑制过渡过程最大动态偏差的作用。
- PD调节有利于提高系统响应速度。
- PD调节抗干扰能力差，一般只能用于被调参数变化平稳的生产过程。
- 微分作用太强容易造成系统振荡。

### PID算法

将比例、积分、微分三种调节规律结合在一起，只要三项作用的强度配合适当，就既能快速调节，又能消除余差，可以得到满意的控制效果。

特点：

- 比例作用是基础控制；微分作用是用于加快系统控制速度；积分作用是用于消除静差。

- 只要比例、积分、微分三项作用的强度配合适当，就既能快速调节，又能消除余差，可以得到满意的控制效果。

- Kp较小时、系统对微分和积分环节的引入较为敏感，积分会引起超调，微分会引起振荡，而振荡剧烈时超调也会增加。

- Kp增大时，积分环节由于滞后产生的超调逐渐减小，此时如果想要继续减少超调可以适当引入微分环节。继续增大Kp系统可能不太稳定，因此在增加Kp的同时引入Kd减小超调，可以保证在Kp不是很大的情况下也能取得较好的稳态特性和动态性能。


### 位置型PID和增量型PID的比较：

- 位置型需要引入初始阀位值，增量型不用
- 位置型需要防止积分饱和（设置积分上限），增量型不会产生积分饱和
- 只有存在偏差时，增量型才会有输出
- 增量型容易实现手动到自动的切换
- 位置型PID控制的输出和整个过去的状态有关，用到了误差的累加值；而增量型PID的输出只与当前拍和前两拍的误差有关，因此位置型PID控制的累积误差相对更大

### 增量型PID优缺点

优点

1. 算式中不需要累加。空孩子增量的确定仅与最近三次的采样值有关，容易通过加权处理获得比较好的控制效果
2. 计算机每次只输出控制增量，即对应执行机构位置的变换量，故机器发生故障时影响范围小，不会严重影响生产过程
3. 手动-自动切换时冲击小。当控制从手动向自动切换时，可以做到勿扰动切换。

缺点

1. 需要对控制量进行记忆
2. 存在稳态误差

PID优化方法：

抗积分饱和

如果系统总是存在统一的方向偏差，就可能无限累加而进行饱和，极大影响系统性能

所谓积分饱和就是指系统存在一个方向的偏差，PID控制器的输出由于积分作用的不断累加而扩大，从而导致控制器输出不断增大超出正常范围进入饱和区。当系统出现反响的偏差时，需要首先从饱和区中退出，而不能对反向的偏差进行快速的响应。

为了解决积分饱和的问题，人们引入了抗积分饱和的PID算法。所谓抗积分饱和算法，其思路就是在计算U(k)的时候，先判断上一个时刻的控制量是否已经超出了限制范围。若U (k-1)>Umax，则只累加负偏差；若U (k-1)<Umin，则只累加正偏差。从而避免控制量长时间停留在饱和区。

几种方法抗饱和积分：

- 积分分离或者称为去积分算法，变速积分（积分项和误差相映射）；

- 增量式PID分步积分与变速积分的融合实现_control_zj的博客-CSDN博客https://blog.csdn.net/control_zj/article/details/79811958

- 在饱和的时候将积分器的累计值初始化到一个比较理想的值；

- 若积分饱和因为目标值突然变化而产生，将目标值以适当斜率的斜坡变化可避免此情形；

- 将积分累计量限制上下限，避免积分累计量超过限制值；

- 如果PID输出已经饱和，重新计算积分累计量，使输出恰好为合理的范围；

- PID的TRICK(一)简述五种PID积分抗饱和（ANTI-Windup）方法 - 知乎 (zhihu.com)https://zhuanlan.zhihu.com/p/49572763

系统对于积分项的要求是，系统偏差大时，积分作用应该减弱甚至是全无，而在偏差小时，则应该加强。积分系数取大了会产生超调，甚至积分饱和，取小了又不能短时间内消除静差。因此，根据系统的偏差大小改变积分速度是有必要的。变积分PID的基本思想三设法改变积分项的累加速度，使其与偏差大小相对应：偏差越大，积分越慢；偏差越小，积分越快。

不完全微分

不完全的微分使得它在偏差作阶跃式变化时出现的输出瞬间跳变得到一定程度的缓和，因而在实际的PID控制算法中得到广泛采用。在PID 控制中，微分信号的引入可以改善系统的动态特性，但也容易引入高频干扰，在误差扰动突变的时候尤其显出微分项的不足。要想解决这个问题，可以在控制算法中加入低通滤波器

标准微分会产生短时间跳变，实际系统不能完全响应，效果不好，会振荡。

微分先行

某些给定值频繁且大幅变化的场合，微分项常常会引起系统的振荡。为了适应这种给定值频繁变化的场合，人们设计了微分现行算法。类似于不完全微分（不完全微分三通过削弱变化量来尽可能的实现完全响应，而微分现行PID控制是只对输出量进行微分，而对给定指令不起微分作用），微分部分只与测量值有关，而且与连续的几个测量值都有关。而与设定值没有关系，设定值的阶跃变化不会造成高频的干扰。

带死区PID控制
在偏差小到一定程度时PID不起作用

https://blog.csdn.net/foxclever/article/details/80778748

在计算机控制系统中，由于系统特性和计算精度等问题导致系统偏差总是存在，系统总是频繁动作不能稳定。为了解决这个情况，我们可以引入带死区的PID算法。

带死区的PID控制算法就算检测偏差值，若是偏差值达到一定程度，就进行调节。若是偏差值较小，就认为没有偏差。

![img](https://i-blog.csdnimg.cn/blog_migrate/eb03e752266ab457bb3c011c782f014f.png)

其中的死区值得选择需要根据具体对象认真考虑，因为该值太小就不起作用，该值过大就可能造成较大滞后，需要根据具体的系统对象来设定。

带死区的PID算法，对无论位置型海斯增量型的表达式都没有影响，不过它是一个非线性系统。

除了以上描述之外还有一个问题，在零点附近时，若偏差很小，进入死区后，偏差置零会造成积分消失。如是系统存在静差，将不能消除，所以需要人为处理这点。

引入死区的主要目的是消除稳定点附近的波动，由于测量值的测量精度和干扰的影响，实际系统中测量值不会真正稳定在某一个具体的值，而与设定之间总会存在偏差，而这一偏差并不是系统真实控制过程的反应，所以引入死区就能较好的消除这一点。

串级PID

 https://cloud.tencent.com/developer/news/464094

https://www.huaweicloud.com/articles/e2ecb27231e2b71bf5cf217378013bad.html

https://www.zhihu.com/question/293450508

https://cloud.tencent.com/developer/news/464094
																																																			
